<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <title>Debugging with mastery</title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"/>

  

  <link rel="stylesheet" type="text/css" href=".//css/highlight/default.css"  />
  <link rel="stylesheet" type="text/css" href=".//css/mermaid-6.0.0.css" />
  <link rel="stylesheet" type="text/css" href=".//css/font-awesome-4.4.0/css/font-awesome.min.css">
  <link rel="stylesheet" type="text/css" href=".//css/introjs-2.5.local.css">
  <link rel="stylesheet" type="text/css" href=".//css/jquery-ui-1.12.1.css">
  <link rel="stylesheet" type="text/css" href=".//css/showoff.css?v=0.19.6" />
  <link rel="stylesheet" type="text/css" href=".//css/zoomline-0.0.1.css">

  <script type="text/javascript" src=".//js/jquery-2.1.4.min.js"></script>
  <script type="text/javascript" src=".//js/jquery-ui-1.12.1.js"></script>

  <script type="text/javascript" src=".//js/jquery.cycle.all-2.8.0.js"></script>
  <script type="text/javascript" src=".//js/jquery.batchImageLoad-1.0.0.js"></script>
  <script type="text/javascript" src=".//js/jquery.parsequery.min-6a20f83.js"></script>
  <script type="text/javascript" src=".//js/jquery.doubletap-4ff02c5.js"></script>
  <script type="text/javascript" src=".//js/highlight.pack-9.2.0.js"></script>
  <script type="text/javascript" src=".//js/jTypeWriter-1.1.js"></script>
  <script type="text/javascript" src=".//js/bigtext-0.1.8.js"></script>
  <script type="text/javascript" src=".//js/zoomline-0.0.1.js"></script>
  <script type="text/javascript" src=".//js/simpleStrings-0.0.1.js"></script>
  <script type="text/javascript" src=".//js/mermaid-6.0.0-min.js"></script>

  <!-- waiting on https://github.com/usablica/intro.js/pull/727 -->
  <script type="text/javascript" src=".//js/intro-2.5.local.js"></script>

  <script type="text/javascript" src=".//js/coffee-script-1.1.3-pre.js"></script>

  <script type="text/javascript" src=".//js/annotations.js?v=0.19.6"></script>
  <script type="text/javascript" src=".//js/showoff.js?v=0.19.6"></script>

  
    <link rel="stylesheet" href=".//file/custom.css" type="text/css"/>
  

  

  <script type="text/javascript">
    $(function(){
      setupPreso(false, './');
    });

    editUrl     = "";
    interactive = false;
    master      = false;
    presenter   = false;

    keymap               = {
  "d": "DEBUG",
  "space": "NEXT",
  "down": "NEXT",
  "right": "NEXT",
  "pagedown": "NEXT",
  "up": "PREV",
  "left": "PREV",
  "pageup": "PREV",
  "SPACE": "NEXTSEC",
  "DOWN": "NEXTSEC",
  "RIGHT": "NEXTSEC",
  "PAGEDOWN": "NEXTSEC",
  "UP": "PREVSEC",
  "LEFT": "PREVSEC",
  "PAGEUP": "PREVSEC",
  "R": "RELOAD",
  "r": "REFRESH",
  "c": "CONTENTS",
  "t": "CONTENTS",
  "h": "HELP",
  "/": "HELP",
  "?": "HELP",
  "b": "BLANK",
  ".": "BLANK",
  "F": "FOOTER",
  "f": "FOLLOW",
  "n": "NOTES",
  "esc": "CLEAR",
  "p": "PAUSE",
  "P": "PRESHOW",
  "x": "EXECUTE",
  "f5": "EXECUTE"
};
    keycode_dictionary   = {
  "0": "\\",
  "8": "backspace",
  "9": "tab",
  "12": "num",
  "13": "enter",
  "16": "shift",
  "17": "ctrl",
  "18": "alt",
  "19": "pause",
  "20": "caps",
  "27": "esc",
  "32": "space",
  "33": "pageup",
  "34": "pagedown",
  "35": "end",
  "36": "home",
  "37": "left",
  "38": "up",
  "39": "right",
  "40": "down",
  "44": "print",
  "45": "insert",
  "46": "delete",
  "48": "0",
  "49": "1",
  "50": "2",
  "51": "3",
  "52": "4",
  "53": "5",
  "54": "6",
  "55": "7",
  "56": "8",
  "57": "9",
  "59": ";",
  "61": "=",
  "65": "a",
  "66": "b",
  "67": "c",
  "68": "d",
  "69": "e",
  "70": "f",
  "71": "g",
  "72": "h",
  "73": "i",
  "74": "j",
  "75": "k",
  "76": "l",
  "77": "m",
  "78": "n",
  "79": "o",
  "80": "p",
  "81": "q",
  "82": "r",
  "83": "s",
  "84": "t",
  "85": "u",
  "86": "v",
  "87": "w",
  "88": "x",
  "89": "y",
  "90": "z",
  "91": "cmd",
  "92": "cmd",
  "93": "cmd",
  "96": "num_0",
  "97": "num_1",
  "98": "num_2",
  "99": "num_3",
  "100": "num_4",
  "101": "num_5",
  "102": "num_6",
  "103": "num_7",
  "104": "num_8",
  "105": "num_9",
  "106": "num_multiply",
  "107": "num_add",
  "108": "num_enter",
  "109": "num_subtract",
  "110": "num_decimal",
  "111": "num_divide",
  "112": "f1",
  "113": "f2",
  "114": "f3",
  "115": "f4",
  "116": "f5",
  "117": "f6",
  "118": "f7",
  "119": "f8",
  "120": "f9",
  "121": "f10",
  "122": "f11",
  "123": "f12",
  "124": "print",
  "144": "num",
  "145": "scroll",
  "173": "-",
  "186": ";",
  "187": "=",
  "188": ",",
  "189": "-",
  "190": ".",
  "191": "/",
  "192": "`",
  "219": "[",
  "220": "\\",
  "221": "]",
  "222": "'",
  "223": "`",
  "224": "cmd",
  "225": "alt",
  "57392": "ctrl",
  "63289": "num"
};
    keycode_shifted_keys = {
  "0": ")",
  "1": "!",
  "2": "@",
  "3": "#",
  "4": "$",
  "5": "%",
  "6": "^",
  "7": "&",
  "8": "*",
  "9": "(",
  "/": "?",
  ".": ">",
  ",": "<",
  "'": "\"",
  ";": ":",
  "[": "{",
  "]": "}",
  "\\": "|",
  "`": "~",
  "=": "+",
  "-": "_",
  "space": "SPACE",
  "down": "DOWN",
  "right": "RIGHT",
  "pagedown": "PAGEDOWN",
  "up": "UP",
  "left": "LEFT",
  "pageup": "PAGEUP"
};
    user_translations    = {
};

    I18n = new translation({"name":"Showoff Presentation","menu":{"title":"Showoff Menu","table_of_contents":"Table of Contents","downloads":"Downloads","feedback":{"label":"Send Feedback","description":"This slide is...","worst":"Terrible","best":"Awesome","why":"Why...?","send":"Send"},"pace":{"label":"The presenter should...","slower":"Slow Down","faster":"Speed Up"},"question":{"label":"Ask a Question","placeholder":"Ask a question..."},"edit":"Edit Current Slide","clear_annotations":"Clear Annotations","language":"Content Language","close":"Close","help":"Press <code>?</code> for help.","anonymous":"All features are anonymous.","sending":"Sending..."},"navigation":{"next":"Next","previous":"Previous","sync":"Sync Presentation"},"loading":"loading presentation...","activity_complete":"Activity complete","follow":{"label":"Follow Mode:"},"refresh":"Are you sure you want to refresh the slide content?\n\n(Use `RELOAD` to fully reload the entire UI)","reload":"Are you sure you want to reload Showoff?","preshow":{"prompt":"Minutes from now to start?","resume":"Resuming in:"},"tour":{"show":"See the Tour","reset":"Reset Hints","welcome":"<h3>Welcome to Showoff</h3>Let me show you around. After you finish this tour, it won't show again.","displayview":"Start by clicking this button to open the Display Window; then drag it onto the projector.","annotations":"Draw on your slides everywhere the presentation is displayed.","timer":"Set a countdown timer to help you stay on pace.","pace":"Audience members can use this to tell you if you're moving too quickly. Try to keep the indicator centered.","questions":"Questions asked by audience members are displayed here. You'll also see a count indicator on the Display Window when you have questions to answer.","notes":"Configure the notes display by zooming text, resizing the pane, or even popping it out into a new window.","slidesource":"The name of the slide is displayed here.","settings":"Would you like a different presenter layout? Choose that and other settings here.","edit":"This button will open your web-based editor--usually something like GitHub.","report":"Don't forget to report issues when you see them.","activity":{"count":"This will count down as audience members mark their activity complete. Their presentations will pause until completed.","complete":"Check this box when you're ready to move on. The presentation will pause while you're working."},"form":{"responses":"As questions are answered, they'll show up as a bar chart with the number of answers to each question on the right.","display":"Press this button to present a snapshot of the live responses on slide.","save":"Press this button to save your responses. The presentation will pause while answering."},"menu":{"start":"Click here to open the menu.","navigation":"Quickly navigate to any slide.","download":"Download presentation support files.","pace":"Provide pace feedback.","questions":"Ask live questions of the presenter.","feedback":"Provide suggestions for improving the content."}},"downloads":{"title":"File Downloads"},"help":{"title":"Help","next":"Move to the next slide.","prev":"Move to the previous slide.","nextsec":"Move to the next section.","prevsec":"Move to the previous section.","contents":"Show the table of contents menu.","follow":"Toggle follow mode.","help":"Show this help dialog.","refresh":"Refresh slide content.","reload":"Completely reload Showoff.","blank":"Blank the screen.","footer":"Toggle the display footer.","notes":"Toggle notes display.","clear":"Clear code execution results.","pause":"Pause the presentation.","preshow":"Display slideshow of <tt>preshow</tt> images on a timer.","execute":"Execute the first visible code block.","debug":"Show debugging information.","close":"Close"},"stats":{"title":"Viewing Statistics","stray":"of your audience is not viewing the same slide you are.","idle":"of your audience is idle.","current":"Slides currently being viewed","elapsed":"Elapsed time spent on each slide","nodata":"No data to display.","allcurrent":"All audience members are viewing the presenter's slide."},"forms":{"display":"Display Results","save":"Save"},"presenter":{"topbar":{"annotations":"Annotations","edit":"Edit Slide","report":"Report Issue With Slide","stats":"Viewing Statistics","downloads":"Downloads","display":"Display Window","print":"Print Slides","settings":"Settings","newpage":"Open in a new page...","tooltip":{"annotations":"Enable the annotations subsystem.","edit":"Edit current slide in new window.","report":"Report an issue with the current slide.","stats":"See the slides your audience is interacting with.","downloads":"Open the file downloads in a menu or new page.","display":"Enable the Display Window; you should put this on the projector.","print":"Print slides using a new window.","settings":"Open the Settings dialog."}},"preview":{"next":"Next","previous":"Previous"},"mobile":{"update":"Update"},"notes":{"label":"Showoff Notes","personal":"Personal Notes"},"timer":{"label":"Timer:","start":"Start","pause":"Pause","resume":"Resume","cancel":"Cancel","unit":"minutes"},"pace":{"faster":"Speed Up!","slower":"Slow Down!"},"questions":"Audience Questions","annotation":{"tools":"Tools","lines":"Lines","shapes":"Shapes"},"status":{"label":"Slides:"},"settings":{"label":"Settings","close":"Close","follower":{"label":"Update Follower","tooltip":"Send slide change notifications.","description":"When this is enabled, the Showoff server will track your slide changes. Disable it to observe the presentation without inadvertently causing slide changes."},"remote":{"label":"Enable Remote","tooltip":"Enables tracking of other presenters.","description":"When this is enabled, you can load the presenter in another browser (typically on your mobile phone) to control the presentation."},"layout":{"label":"Layout","default":"Default Layout","thumbs":"Display thumbnail previews of the next and previous slides.","beside":"Display the next slide as a large preview in the main presenter view.","floating":"Open the next slide as a floating window.","confirmation":"Browser security requires confirmation before opening a new window.","open":"Open Window","cancel":"cancel","reset":{"label":"Clear Showoff settings.","tooltip":"Reset Showoff UI settings to default values."}},"language":{"label":"Content Language","tooltip":"Select from available translations, or autoselect based on your browser settings.","description":"This presentation is available in different languages. Choose the language you would like to view or leave it at <tt>automatic</tt> to use your browser settings."}},"print":{"label":"Choose type of printed notes","description":"Select the content you'd like to show under the slides.","none":"Don't include notes","notes":"Presenter Notes","handouts":"Audience Handouts"}},"language":{"auto":"Automatic","disable":"Disable Translations"},"error":{"file_not_found":"File Not Found!"}});

  </script>

</head>

<body>
<div id="questionsIndicator"></div>

<i id="hamburger" class="fa fa-bars fa-2x"></i>
<div id="sidebarWrapper">
    <div id="navigationHover"></div>
    <div id="feedbackSidebar" class="sideMenu">
    <img id="disconnected" src=".//css/disconnected.png">
    <h3>Showoff Menu</h3>
    <div id="navToggle" class="buttonWrapper"><i class=" fa fa-bookmark"></i> Table of Contents</div>
    <div id="navigation" class="submenu"></div>
    
    <hr>

    

    

    <div id="closeMenu" class="buttonWrapper"><i class="fa fa-close"></i> Close</div>
    <hr>

    <small>
        <p>Press <code>?</code> for help.</p>
        <p>All features are anonymous.</p>
    </small>
    </div>
    <div id="sidebarExit"></div>
</div>
<div id="help-modal" title="Help">
  <div id="help">
    <div>
      <span class="description">Move to the next slide.</span>
      <span class="action">NEXT</span>
      <span class="hotkeys"><span class="key">space</span><span class="key">down</span><span class="key">right</span><span class="key">pagedown</span></span>
    </div>
    <div>
      <span class="description">Move to the previous slide.</span>
      <span class="action">PREV</span>
      <span class="hotkeys"><span class="key">up</span><span class="key">left</span><span class="key">pageup</span></span>
    </div>
    <div>
      <span class="description">Move to the next section.</span>
      <span class="action">NEXTSEC</span>
      <span class="hotkeys"><span class="key">SPACE</span><span class="key">DOWN</span><span class="key">RIGHT</span><span class="key">PAGEDOWN</span></span>
    </div>
    <div>
      <span class="description">Move to the previous section.</span>
      <span class="action">PREVSEC</span>
      <span class="hotkeys"><span class="key">UP</span><span class="key">LEFT</span><span class="key">PAGEUP</span></span>
    </div>
    <div>
      <span class="description">Show the table of contents menu.</span>
      <span class="action">CONTENTS</span>
      <span class="hotkeys"><span class="key">c</span><span class="key">t</span></span>
    </div>
    <div>
      <span class="description">Toggle follow mode.</span>
      <span class="action">FOLLOW</span>
      <span class="hotkeys"><span class="key">f</span></span>
    </div>
    <div>
      <span class="description">Show this help dialog.</span>
      <span class="action">HELP</span>
      <span class="hotkeys"><span class="key">h</span><span class="key">/</span><span class="key">?</span></span>
    </div>

    <hr />

    <div>
      <span class="description">Refresh slide content.</span>
      <span class="action">REFRESH</span>
      <span class="hotkeys"><span class="key">r</span></span>
    </div>
    <div>
      <span class="description">Completely reload Showoff.</span>
      <span class="action">RELOAD</span>
      <span class="hotkeys"><span class="key">R</span></span>
    </div>
    <div>
      <span class="description">Blank the screen.</span>
      <span class="action">BLANK</span>
      <span class="hotkeys"><span class="key">b</span><span class="key">.</span></span>
    </div>
    <div>
      <span class="description">Toggle the display footer.</span>
      <span class="action">FOOTER</span>
      <span class="hotkeys"><span class="key">F</span></span>
    </div>
    <div>
      <span class="description">Toggle notes display.</span>
      <span class="action">NOTES</span>
      <span class="hotkeys"><span class="key">n</span></span>
    </div>
    <div>
      <span class="description">Clear code execution results.</span>
      <span class="action">CLEAR</span>
      <span class="hotkeys"><span class="key">esc</span></span>
    </div>
    <div>
      <span class="description">Pause the presentation.</span>
      <span class="action">PAUSE</span>
      <span class="hotkeys"><span class="key">p</span></span>
    </div>
    <div>
      <span class="description">Display slideshow of <tt>preshow</tt> images on a timer.</span>
      <span class="action">PRESHOW</span>
      <span class="hotkeys"><span class="key">P</span></span>
    </div>
    <div>
      <span class="description">Execute the first visible code block.</span>
      <span class="action">EXECUTE</span>
      <span class="hotkeys"><span class="key">x</span><span class="key">f5</span></span>
    </div>

    <hr />

    <div>
      <span class="description">Show debugging information.</span>
      <span class="action">DEBUG</span>
      <span class="hotkeys"><span class="key">d</span></span>
    </div>
  </div>
</div>

<div id="preso"><center>loading presentation...</center></div>
<a id="synchronize"><i class="fa fa-link" aria-hidden="true" href="#"></i> Sync Presentation</a>
<div id="notes"></div>

<footer id="footer">
  <span id="followLabel" class="container">Follow Mode: <i id="followMode" class="fa fa-ban" aria-hidden="true"></i></span>
  <span id="slideInfo" class="container"></span>
  <span id="debugInfo" class="container"></span>
  <span id="notesInfo" class="container"></span>
  <span id="slideFilename" class="container"></span>
  <img id="disconnected" src=".//css/disconnected.png" />
</footer>

<div id="slides" class="offscreen" style="display:none;">
<div data-section="intro" data-title="slide01" id="intro_slide011" class="slide center subsection" data-transition="none">
<div class="content center subsection" ref="intro/slide01:1">
<h1>Debugging with mastery in Ruby</h1>

<h2>Fabio Perrella</h2>

<h3>Tech Leader @ Locaweb</h3>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="intro" data-title="slide01" id="intro_slide012" class="slide center" data-transition="none">
<div class="content center" ref="intro/slide01:2">
<h1>Help others to lose less time debugging like I used to lose</h1>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="intro" data-title="slide01" id="intro_slide013" class="slide center" data-transition="none">
<div class="content center" ref="intro/slide01:3">
<h1>Idea</h1>

<h2>Show how I used to do and what I've learned</h2>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="intro" data-title="slide01" id="intro_slide014" class="slide center" data-transition="none">
<div class="content center" ref="intro/slide01:4">
<h1>Before we start...</h1>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="intro" data-title="slide01" id="intro_slide015" class="slide smallbullets" data-transition="none">
<div class="content smallbullets" ref="intro/slide01:5">
<h1>Tools</h1>

<ul>
<li>pry

<ul>
<li>code inspection</li>
<li>beautiful console</li>
</ul>
</li>
<li>pry-debugger

<ul>
<li>old debugger (before ruby 2.0.0)</li>
</ul>
</li>
<li>byebug

<ul>
<li>"new" debugger (after ruby 2.0.0)</li>
</ul>
</li>
<li>pry-byebug

<ul>
<li>pry + byebug (but byebug alone has some advantages!)</li>
</ul>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="intro" data-title="slide01" id="intro_slide016" class="slide smallbullets" data-transition="none">
<div class="content smallbullets" ref="intro/slide01:6">
<h1>.pryrc</h1>

<pre class="highlight"><code class="language-bash">$ cat ~/.pryrc
Pry.commands.alias_command 'c', 'continue'
Pry.commands.alias_command 's', 'step'
Pry.commands.alias_command 'n', 'next'
Pry.commands.alias_command 'f', 'finish'
Pry.commands.alias_command 'w', 'whereami'
Pry.commands.alias_command 'bt', 'backtrace'

Pry.config.editor = "vim"</code></pre>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="intro" data-title="slide01" id="intro_slide017" class="slide smallbullets" data-transition="none">
<div class="content smallbullets" ref="intro/slide01:7">
<h1>Snippets (using Sublime Text)</h1>

<ul>
<li>bp (binding.pry)

<ul>
<li><a href="https://github.com/fabioperrella/dotfiles/blob/master/sublime/pry.sublime-snippet" target="_blank">https://github.com/fabioperrella/dotfiles/blob/master/sublime/pry.sublime-snippet</a></li>
</ul>
</li>
<li>bb (byebug)

<ul>
<li><a href="https://github.com/fabioperrella/dotfiles/blob/master/sublime/byebug.sublime-snippet" target="_blank">https://github.com/fabioperrella/dotfiles/blob/master/sublime/byebug.sublime-snippet</a></li>
</ul>
</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="intro" data-title="slide01" id="intro_slide018" class="slide" data-transition="none">
<div class="content " ref="intro/slide01:8">
<h1>Problem</h1>

<h2>Taking control of the debugger!</h2>

<p><img src="./file//_images/dog_leash.gif" alt=""></p>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="intro" data-title="slide01" id="intro_slide019" class="slide" data-transition="none">
<div class="content " ref="intro/slide01:9">
<h1>Netflix fake recommendations app</h1>

<p>Understand why the show "Vai Anita" is recommended to everybody!?!?!</p>

<p><a href="https://github.com/fabioperrella/fake-netflix-recommendations" target="_blank">https://github.com/fabioperrella/fake-netflix-recommendations</a></p>

<p><strong>Warning</strong>: This is a crazy app, just to show some debugging scenarios!</p>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="intro" data-title="slide01" id="intro_slide0110" class="slide center" data-transition="none">
<div class="content center" ref="intro/slide01:10">
<h1>Show me the code!</h1>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="intro" data-title="slide01" id="intro_slide0111" class="slide center" data-transition="none">
<div class="content center" ref="intro/slide01:11">
<h1>Understanding the flow of execution to understand the <code>step(in)</code> command</h1>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="intro" data-title="slide01" id="intro_slide0112" class="slide smaller" data-transition="none">
<div class="content smaller" ref="intro/slide01:12">
<h1>Code execution tree</h1>

<pre class="highlight"><code class="language-text">UserRecommendations.list
├── UserRecommendations#list
│   ├── fetchers
│   ├── sort_by
│   │   ├── ItemsFetcher::Main.order
│   │   ├── ItemsFetcher::Secondary.order
│   │   ├── ItemsFetcher::Sponsored.order
│   ├── map
│   │   ├── ItemsFetcher::Main.fetch
│   │   │   ├── ItemsFetcher::Main#fetch
│   │   │   │   ├── ItemsFetcher::Main#main_preferences
│   │   ├── ItemsFetcher::Secondary.fetch
│   │   │   ├── ItemsFetcher::Secondary#fetch
│   │   │   │   ├── ItemsFetcher::Secondary#secondary_preferences
│   │   ├── ItemsFetcher::Sponsored.fetch
│   │   │   ├── ItemsFetcher::Sponsored#fetch
│   │   │   │   ├── ItemsFetcher::Sponsored#fetch
│   │   │   │   │   ├── each
│   │   │   │   │   │   ├── SponsoredMetrics.new
│   │   │   │   │   │   │   ├── SponsoredMetrics#save
│   │   │   │   │   │   │   │   ├── SponsoredMetrics#key
│   │   │   │   │   │   │   │   ├── SponsoredMetrics#value
│   │   │   │   │   │   │   │   ├── Metrics.save
│   │   │   │   │   │   │   │   │   ├── Rails.cache.save
│   ├── inject
│   ├── reject
│   │   ├── UserRecommendations#watched_items</code></pre>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="intro" data-title="slide01" id="intro_slide0113" class="slide" data-transition="none">
<div class="content " ref="intro/slide01:13">
<h1>Suggestion</h1>

<p>Build a gem to build this tree automatically!</p>

<p>I used the gem <code>tty-tree</code> to build it manually</p>

<pre class="highlight"><code class="language-ruby">require 'tty-tree'

tree = TTY::Tree.new do
  node 'UserRecommendations.list' do
    node 'UserRecommendations#list' do
      node 'fetchers'
      node 'sort_by' do
        node 'ItemsFetcher::Main.order' do
        end
        node 'ItemsFetcher::Secondary.order' do
        end
        node 'ItemsFetcher::Sponsored.order' do
        end
      end
...</code></pre>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="intro" data-title="slide01" id="intro_slide0114" class="slide" data-transition="none">
<div class="content " ref="intro/slide01:14">
<h1>Deep down in the code with byebug</h1>

<ol>
<li>Add a <code>binding.pry</code> in <code>NETFLIX/app/services/user_recommendations.rb:3</code>
</li>
<li>Run test <code>spec/services/user_recommendations_spec.rb:49</code>
</li>
<li>Use <code>step</code> to deep down</li>
<li>Use <code>next</code> to execute the line and go to the next

<ul>
<li>Unfortunately, there is no <code>step-back</code> command :(</li>
</ul>
</li>
<li>Use <code>finish</code> to run the current frame until the end</li>
<li>Use <code>up</code> and <code>down</code> to know where in the stack I am, and inspect some variable</li>
<li>Use <code>next</code> to execute the line and go to the next line</li>
<li>Use <code>backtrace</code> and <code>frame</code> to show the current frame</li>
<li>Use <code>whereami</code> to show where the debugger is</li>
</ol>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="intro" data-title="slide01" id="intro_slide0115" class="slide center" data-transition="none">
<div class="content center" ref="intro/slide01:15">
<h1>STEP / UP / DOWN / FINISH</h1>

<h3>If you have only 1 slot to learn something from this talk, save this!</h3>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="intro" data-title="slide01" id="intro_slide0116" class="slide small" data-transition="none">
<div class="content small" ref="intro/slide01:16">
<h1>Another example in real life</h1>

<p><img src="./file//_images/how_to_use_up.png" alt=""></p>

<p>Using <code>up</code>, <code>down</code> and <code>frame</code> to understand what happened before it gets in
the breakpoint.</p>

<pre class="highlight"><code class="language-ruby"># PM/lib/recipes_manager/client.rb:16
class Client
  def post_bundle(bundle)
    binding.pry
    response = http.post('bundles', bundle.as_json)

    return response.body if response.success?

    # ....
  end
end</code></pre>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="intro" data-title="slide01" id="intro_slide0117" class="slide" data-transition="none">
<div class="content " ref="intro/slide01:17">
<h1>Using the <code>play</code> command to run lines</h1>

<p>Good code (to play):</p>

<pre class="highlight"><code class="language-ruby">fetchers
  .sort_by(&amp;:order)
  .map{ |fetcher| fetcher.fetch(user) }
  .inject(:+)
  .reject { |item| watched_items.include?(item) }

# play -l 1..2
# play -l 1..3
# play -l 1..4</code></pre>

<p>Bad code (to play):</p>

<pre class="highlight"><code class="language-ruby">fetchers.sort_by(&amp;:order).map{ |fetcher| fetcher.fetch(user) }.inject(:+).reject { |item| watched_items.include?(item) }

# play -l 1 :(</code></pre>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="intro" data-title="slide01" id="intro_slide0118" class="slide" data-transition="none">
<div class="content " ref="intro/slide01:18">
<h1>Debugging a code inside a block</h1>

<pre class="highlight"><code class="language-ruby"># app/services/item_remover.rb
def remove(item)
  binding.pry
  ActiveRecord::Base.transaction do
    UserItemLog.where(item: item).destroy_all
    item.destroy
  end
end</code></pre>

<ul>
<li>Avoid using <code>step</code> to go into the block</li>
<li>Use <code>break [LINE]</code> and <code>continue</code> for the win!</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="intro" data-title="slide01" id="intro_slide0119" class="slide smaller" data-transition="none">
<div class="content smaller" ref="intro/slide01:19">
<h1>Debugging a code inside a loop</h1>

<pre class="highlight"><code class="language-ruby"># app/services/create_preference.rb
def create(name, items)
  binding.pry
  ActiveRecord::Base.transaction do
    items.each do |item|
      item.preferences &lt;&lt; name

      item.user_item_logs.each do |item_log|
        user = item_log.user
        unless user.preferences.include?(name)
          user.preferences &lt;&lt; name
          user.save!
        end
      end

      item.save!
    end
  end
end</code></pre>

<ul>
<li>Use <code>break 10 if user.id == x</code> to not stop in each element</li>
<li>Use <code>break</code> to list breakpoints</li>
<li>Use <code>break --delete x</code> to delete a breakpoint</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="intro" data-title="slide01" id="intro_slide0120" class="slide" data-transition="none">
<div class="content " ref="intro/slide01:20">
<h1>When you forgot a <code>binding.pry</code> and run all tests...</h1>

<ul>
<li>Use command <code>edit -c</code> to edit the current file (<code>Pry.config.editor</code> must be configured)</li>
<li>Remove the <code>binding.pry</code>
</li>
<li>Save and close the file</li>
<li>Continue the execution of the tests!</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="intro" data-title="slide01" id="intro_slide0121" class="slide center" data-transition="none">
<div class="content center" ref="intro/slide01:21">
<h1>Now, some <code>pry</code> stuff...</h1>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="intro" data-title="slide01" id="intro_slide0122" class="slide" data-transition="none">
<div class="content " ref="intro/slide01:22">
<h1>Using <code>pry</code> to browse source code regardless of a debug session</h1>

<ol>
<li>when debugging, the <code>pry</code> tools are available (with <code>pry-byebug</code>), but when
only in <code>pry</code> console, the debug commands are not available</li>
<li>Use <code>rails c</code> to enter the console</li>
<li>Use <code>cd</code> to inspect a class or instance</li>
<li>Use <code>nesting</code> to show where I am</li>
<li>Use <code>ls</code> to show the methods and variables</li>
<li>Use <code>ls --grep XX</code> to filter the result of <code>ls</code>
</li>
<li>Use <code>show-source</code> (or <code>$</code>) to show the current source</li>
<li>Use <code>show-source</code> to show the source of some method</li>
</ol>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="intro" data-title="slide01" id="intro_slide0123" class="slide smaller" data-transition="none">
<div class="content smaller" ref="intro/slide01:23">
<h1>Using show-doc to show the docs</h1>

<p>Use <code>show-doc</code> do show the docs (requires gem <code>pry-doc</code>):</p>

<pre class="highlight"><code class="language-ruby">[2] pry&gt; show-doc Array#all?

From: enum.c (C Method):
Owner: Enumerable
Visibility: public
Signature: all?(*arg1)
Number of lines: 16

Passes each element of the collection to the given block. The method
returns true if the block never returns
false or nil. If the block is not given,
Ruby adds an implicit block of { |obj| obj } which will
cause #all? to return true when none of the collection members are
false or nil.

If instead a pattern is supplied, the method returns whether
pattern === element for every collection member.

   %w[ant bear cat].all? { |word| word.length &gt;= 3 } #=&gt; true
   %w[ant bear cat].all? { |word| word.length &gt;= 4 } #=&gt; false
   %w[ant bear cat].all?(/t/)                        #=&gt; false
   [1, 2i, 3.14].all?(Numeric)                       #=&gt; true
   [nil, true, 99].all?                              #=&gt; false
   [].all?                                           #=&gt; true</code></pre>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="intro" data-title="slide01" id="intro_slide0124" class="slide small" data-transition="none">
<div class="content small" ref="intro/slide01:24">
<h1>To avoid printing a lot of stuff to stdout</h1>

<p>Without <code>;</code> in the end</p>

<pre class="highlight"><code class="language-ruby">[11] pry(main)&gt; conn = ActiveRecord::Base.connection
=&gt; #&lt;ActiveRecord::ConnectionAdapters::SQLite3Adapter:0x000055e01c45ee60
 @active=true,
 @config={:adapter=&gt;"sqlite3", :pool=&gt;5, :timeout=&gt;5000, :database=&gt;"/home/fabio/workspace/fake-netflix-recommendations/db/development.sqlite3"},
 @connection=
  #&lt;SQLite3::Database:0x000055e01c45f0b8
   @authorizer=nil,
   @busy_handler=nil,
   @collations={},
   @encoding=#&lt;Encoding:UTF-8&gt;,
#...</code></pre>

<p>With <code>;</code> in the end</p>

<pre class="highlight"><code class="language-ruby">[12] pry(main)&gt; conn = ActiveRecord::Base.connection;
[13] pry(main)&gt; conn.class
=&gt; ActiveRecord::ConnectionAdapters::SQLite3Adapter</code></pre>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="intro" data-title="slide01" id="intro_slide0125" class="slide small" data-transition="none">
<div class="content small" ref="intro/slide01:25">
<h1>Catching the last exception with <code>_ex_</code>
</h1>

<pre class="highlight"><code class="language-ruby">[1] pry&gt; 1/0
ZeroDivisionError: divided by 0
from (pry):1:in `/`
[2] pry&gt; _ex_
=&gt; #&lt;ZeroDivisionError: divided by 0&gt;</code></pre>

<p>And it is possible to find where it was raised with <code>cat --ex</code>:</p>

<pre class="highlight"><code class="language-ruby">[3] pry&gt; cat --ex

Exception: ZeroDivisionError: divided by 0
--
From: (pry) @ line 5 @ level: 0 of backtrace (of 82).

    1: 1/0
    2: _ex_
    3: Item.new
    4: aa = _
 =&gt; 5: 1/0
    6: _ex_</code></pre>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="intro" data-title="slide01" id="intro_slide0126" class="slide" data-transition="none">
<div class="content " ref="intro/slide01:26">
<h1>Getting the last result with <code>_</code>
</h1>

<pre class="highlight"><code class="language-ruby">[1] pry&gt; Item.new
=&gt; #&lt;Item:0x00005578e8d1dba0 id: nil, name: nil, #...
[2] pry&gt; item = _
=&gt; #&lt;Item:0x00005578e8d1dba0 id: nil, name: nil, #...</code></pre>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="intro" data-title="slide01" id="intro_slide0127" class="slide" data-transition="none">
<div class="content " ref="intro/slide01:27">
<h1>Pry input buffer</h1>

<p>Given the code below</p>

<pre class="highlight"><code class="language-ruby">pry(main)&gt; def do_something
pry(main)*   if x == 1
pry(main)*     puts 'sim'
pry(main)*   else</code></pre>

<ul>
<li>Use command <code>edit</code> to edit the input buffer</li>
<li>Use command <code>show-input</code> to show</li>
<li>Use command <code>edit</code> to edit</li>
<li>Use <code>!</code> to clear</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="intro" data-title="slide01" id="intro_slide0128" class="slide" data-transition="none">
<div class="content " ref="intro/slide01:28">
<h1>Executing shell commands</h1>

<p>Use <code>.</code> (dot) and a command, example:</p>

<pre class="highlight"><code class="language-ruby">pry&gt; .ruby -v
ruby 2.5.3p105 (2018-10-18 revision 65156) [x86_64-linux]

pry&gt; .pwd
/home/fabio/workspace/fake-netflix-recommendations</code></pre>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="intro" data-title="slide01" id="intro_slide0129" class="slide" data-transition="none">
<div class="content " ref="intro/slide01:29">
<h1>How to exit from a pry console</h1>

<ul>
<li>When using <code>ctrl+c</code>, it always <strong>CRASHES THE TERMINAL !!</strong>

<ul>
<li>Use the command <code>reset</code> to restore the terminal</li>
</ul>
</li>
<li>When using <code>exit</code>, it exits only the current context</li>
<li>When using <code>exit!</code>, it exists the console, no matter where you are</li>
</ul>
</div>
<canvas class="annotations"></canvas>
</div>
<div data-section="intro" data-title="slide01" id="intro_slide0130" class="slide small" data-transition="none">
<div class="content small" ref="intro/slide01:30">
<h1>Finish him! Questions??</h1>

<h2>Pics</h2>

<p>The source of this presentation: <a href="https://github.com/fabioperrella/debugging-with-mastery" target="_blank">https://github.com/fabioperrella/debugging-with-mastery</a></p>

<p>This presentation was made with the gem <strong>Showoff</strong>: <a href="https://github.com/puppetlabs/showoff" target="_blank">https://github.com/puppetlabs/showoff</a></p>

<p>How to find a subject to do a presentation: <a href="http://www.greaterthancode.com/2016/11/21/008-sandi-metz-and-katrina-owen/" target="_blank">http://www.greaterthancode.com/2016/11/21/008-sandi-metz-and-katrina-owen/</a></p>

<h2>Me</h2>

<p><a href="https://github.com/fabioperrella" target="_blank">https://github.com/fabioperrella</a></p>

<p><a href="http://twitter.com/fabioperrella" target="_blank">http://twitter.com/fabioperrella</a></p>

<h2>Work at Locaweb</h2>

<p><a href="https://www.locaweb.com.br/carreira" target="_blank">https://www.locaweb.com.br/carreira</a></p>
</div>
<canvas class="annotations"></canvas>
</div>
</div>
<div id="buttonNav">
  <div id="buttonPrev"><i class="fa fa-chevron-left fa-lg"></i> Previous</div><div id="buttonNext">Next <i class="fa fa-chevron-right fa-lg"></i></div>
</div>
<div id="pauseScreen">
  PAUSED
</div>

  <script defer type="text/javascript">
    // We want the audience members to see automatic tours. We can assume that they won't be
    // using many server domains like the presenter might.
    var autoTour = true;

    $( document ).ready(function() {
      if(presenter && !window.opener) {
        alert('This is an audience view designed for interactivity. If you are placing this window on a projector, you should use the Display View instead.');
      }

      tours['showoff:activity'] = [
        {
          element: ".currentSlide .activityToggle",
          intro: I18n.t('tour.activity.complete')
        }
      ];

      tours['showoff:form'] = [
        {
          element: ".currentSlide input.save",
          intro: I18n.t('tour.form.save')
        }
      ];

      tours['showoff:menu'] = [
        {
          element: "#hamburger",
          intro: I18n.t('tour.menu.start')
        },
        {
          element: "#navToggle",
          intro: I18n.t('tour.menu.navigation')
        },
        {
          element: "#fileDownloads",
          intro: I18n.t('tour.menu.download')
        },
        {
          element: "#paceFaster",
          intro: I18n.t('tour.menu.pace')
        },
        {
          element: "#questionToggle",
          intro: I18n.t('tour.menu.questions')
        },
        {
          element: "#feedbackToggle",
          intro: I18n.t('tour.menu.feedback')
        }
      ].filter(function(item) { return (document.querySelector(item['element'])) });
      // display tips for only the enabled features
    });
  </script>

</body>
</html>
